# –ü–ê–ü–ê–ñ–ö–• ‚Äî LOGIC_SPEC v1.5.3

–í–µ—Ä—Å–∏—è: **1.5.3**  
–î–∞—Ç–∞ —Ñ–∏–∫—Å–∞—Ü–∏–∏: **2026-01-27**  
–°—Ç–∞—Ç—É—Å: **–°–¢–ê–ë–ò–õ–ò–ó–ê–¶–ò–Ø / –ö–û–ù–¢–†–û–õ–¨ –ò–ù–í–ê–†–ò–ê–ù–¢–û–í**

---

## üîí –≠–¢–ê–õ–û–ù –ü–†–û–ï–ö–¢–ê (CRITICAL)

–≠—Ç–∞–ª–æ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ (–∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∏ UI-—ç—Ç–∞–ª–æ–Ω):
```
jkh_site_full_v01.27.3.zip
SHA256: 6b4254a9b3b74327fe2d2c48c34e3e446ba9ae4e3369c6c554a683bde7b6ceec
```

–õ—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ –ø–æ–≤–µ—Ä—Ö —ç—Ç–∞–ª–æ–Ω–∞** –∏ **—Ç–æ–ª—å–∫–æ —Å —Ñ–∏–∫—Å–∞—Ü–∏–µ–π –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ LOGIC_SPEC**.

---

## 0. –û–±–ª–∞—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏—è

LOGIC_CHECKLIST v1.4 ‚Äî –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã, **–Ω–µ –∏–∑–º–µ–Ω—è—Ç—å**.

---

## 1. –ò—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã (CRITICAL)

**–ö–∞—Ä—Ç–æ—á–∫–∞ –∞–±–æ–Ω–µ–Ω—Ç–∞** (UI-—Ç–∞–±–ª–∏—Ü–∞ –æ–ø–ª–∞—Ç—ã/–Ω–∞—á–∏—Å–ª–µ–Ω–∏–π/–ø–µ–Ω–∏) ‚Äî **–∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã**.

–°–ª–µ–¥—Å—Ç–≤–∏—è:
- –æ—Ç—á—ë—Ç—ã/—Å–ø—Ä–∞–≤–∫–∏ (–≤–∫–ª—é—á–∞—è ¬´–°–ø—Ä–∞–≤–∫–∞ –¥–ª—è —Å—É–¥–∞¬ª) —Å—á–∏—Ç–∞—é—Ç—Å—è **–ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–º–∏**;
- –ª—é–±—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —Å–ø—Ä–∞–≤–∫–∞—Ö **–Ω–µ –∏–º–µ—é—Ç –ø—Ä–∞–≤–∞ –º–µ–Ω—è—Ç—å**:
  - —Ä–∞—Å—á—ë—Ç –≤ –∫–∞—Ä—Ç–æ—á–∫–µ,
  - –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ `payments_<LS>`,
  - –ø—Ä–∞–≤–∏–ª–∞ anti-retro.

---

## 2. payments_<LS> ‚Äî –µ–¥–∏–Ω—ã–π –ø–æ–º–µ—Å—è—á–Ω—ã–π ledger (CRITICAL)

`payments_<LS>` (–Ω–∞–ø—Ä–∏–º–µ—Ä `payments_0001`) ‚Äî **–µ–¥–∏–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞-—Ä–µ–µ—Å—Ç—Ä –ø–æ –º–µ—Å—è—Ü–∞–º**, –∞ –Ω–µ –∂—É—Ä–Ω–∞–ª —Å–æ–±—ã—Ç–∏–π.

–í –æ–¥–Ω–æ–º –º–µ—Å—è—Ü–µ –¥–æ–ø—É—Å—Ç–∏–º–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫:
- —Å—Ç—Ä–æ–∫–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è (accrued > 0), —á–∞—Å—Ç–æ `locked/import_locked`;
- –æ–¥–Ω–∞ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –æ–ø–ª–∞—Ç (paid > 0).

–ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ –º–µ—Å—è—Ü—É:
- `accruedYM = max(accrued)` –ø–æ —Å—Ç—Ä–æ–∫–∞–º –º–µ—Å—è—Ü–∞
- `paidYM = sum(paid)` –ø–æ –≤—Å–µ–º —Å—Ç—Ä–æ–∫–∞–º –º–µ—Å—è—Ü–∞
- `debtYM = max(0, accruedYM - paidYM)`

---

## 3. –û–ø–ª–∞—Ç–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ (CRITICAL)

`use_period / pay_for_period / period_from / period_to`:
- –≤–ª–∏—è–µ—Ç **–¢–û–õ–¨–ö–û** –Ω–∞ —Ä–∞—Å—á—ë—Ç/–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ–Ω–∏;
- **–Ω–µ –º–µ–Ω—è–µ—Ç** –æ—Å–Ω–æ–≤–Ω–æ–π –¥–æ–ª–≥;
- **–Ω–µ –º–µ–Ω—è–µ—Ç** —Ñ–∞–∫—Ç–∏—á–µ—Å–∫—É—é –¥–∞—Ç—É –æ–ø–ª–∞—Ç—ã;
- **–Ω–µ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–µ—Ç** –ø—Ä–æ—à–ª—ã–µ –º–µ—Å—è—Ü—ã (anti-retro).

---

## 4. –ò—Å–∫–ª—é—á—ë–Ω–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã (CRITICAL)

–í–∫–ª—é—á–µ–Ω–∏–µ ¬´–∏—Å–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–∏–æ–¥ —Ä–∞—Å—á—ë—Ç–∞¬ª:
- –æ—Ç–∫–ª—é—á–∞–µ—Ç **—Ç–æ–ª—å–∫–æ –ø–µ–Ω—é** –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –¥–∞—Ç–∞—Ö;
- –æ—Å–Ω–æ–≤–Ω–æ–π –¥–æ–ª–≥ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–ª–∞—Ç—ë–∂) –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è.

–ï—Å–ª–∏ –≤–∫–ª—é—á–∏–ª–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –∞ –ø–µ–Ω—è –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è ‚Äî —ç—Ç–æ **BUG**.

---

## 5. –°–ø—Ä–∞–≤–∫–∞ –¥–ª—è —Å—É–¥–∞ (CRITICAL)

- –ö–æ–ª–æ–Ω–∫–∏ ¬´–ú–µ—Å—è—á–Ω–∞—è –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å¬ª (–ø–æ –¥–æ–ª–≥—É/–ø–æ –ø–µ–Ω–∏) —Å—á–∏—Ç–∞—é—Ç—Å—è **—Å—Ç—Ä–æ–≥–æ –∑–∞ –º–µ—Å—è—Ü**, –ø–æ—Å—Ç—Ä–æ—á–Ω–æ, –±–µ–∑ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è.
- –ò—Ç–æ–≥–æ–≤—ã–π –±–ª–æ–∫ ¬´–ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é –Ω–∞ ‚Ä¶¬ª —Å—á–∏—Ç–∞–µ—Ç—Å—è **–Ω–∞—Ä–∞—Å—Ç–∞—é—â–∏–º –∏—Ç–æ–≥–æ–º** –∏ **–æ–±—è–∑–∞–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å** —Å –∫–∞—Ä—Ç–æ—á–∫–æ–π –∞–±–æ–Ω–µ–Ω—Ç–∞ –Ω–∞ —Ç—É –∂–µ –¥–∞—Ç—É.

---

## 6. ES-modules (CRITICAL –∑–∞–ø—Ä–µ—Ç –¥–ª—è v1.5.x)

–í –≤–µ—Ä—Å–∏–∏ v1.5.x –∑–∞–ø—Ä–µ—â–µ–Ω–æ:
- `type="module"`,
- `import/export`,
- –ø–µ—Ä–µ–Ω–æ—Å —Ä–∞—Å—á—ë—Ç–æ–≤ –≤ –º–æ–¥—É–ª—å–Ω—É—é —Å–±–æ—Ä–∫—É.

–ü—Ä–∏—á–∏–Ω–∞: –ø—Ä–æ–µ–∫—Ç –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å **file://** –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –¥–∞–≤–∞—Ç—å —é—Ä–∏–¥–∏—á–µ—Å–∫–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–µ —Ü–∏—Ñ—Ä—ã.

---

## 7. –ò–∑–º–µ–Ω–µ–Ω–∏—è –∏ —Ñ–∏–∫—Å–∞—Ü–∏—è

–ü—Ä–∞–≤–∏–ª–æ:
- –õ—é–±–∞—è –ø—Ä–∞–≤–∫–∞ —Ä–∞—Å—á—ë—Ç–æ–≤ –∏–ª–∏ —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö ‚Üí –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è LOGIC_SPEC + –∑–∞–ø–∏—Å—å –≤ CRITICAL_CHANGELOG + —Ä–µ–≥—Ä–µ—Å—Å-—Ç–µ—Å—Ç—ã.

