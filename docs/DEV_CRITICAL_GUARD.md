# üß± DEV CRITICAL GUARD (UI-–ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å)

–î–∞—Ç–∞: 2026-01-27

## –ß—Ç–æ —ç—Ç–æ
`critical_guard.js` ‚Äî dev-only —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è, —Å–ø–æ—Å–æ–±–Ω—ã–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞—Å—á—ë—Ç—ã (–∞ –∑–Ω–∞—á–∏—Ç ‚Äî —é—Ä–∏–¥–∏—á–µ—Å–∫—É—é –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å).

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
- –≤–∫–ª—é—á—ë–Ω `type="module"` (ES-modules);
- –Ω–∞—Ä—É—à–µ–Ω –ø–æ—Ä—è–¥–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `calc_engine.js` –ø–æ—Å–ª–µ `payment_table.js` / `spravka_sud.js`);
- –≤ `spravka_sud.html` –ø–æ–¥–∫–ª—é—á—ë–Ω `storage.js` (–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ –ª–æ–º–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫—É/–¥–∞–Ω–Ω—ã–µ).

## –ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å
- –î–æ–±–∞–≤—å –∫ URL –ø–∞—Ä–∞–º–µ—Ç—Ä: `?dev=1`
- –ò–ª–∏ –∑–∞–ø—É—Å–∫–∞–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ `localhost` / `127.0.0.1`

–ü—Ä–∏–º–µ—Ä—ã:
- `index.html?dev=1`
- `abonent_card.html?dev=1`
- `spravka_sud.html?dev=1`

## –†–µ–∂–∏–º HARD STOP (dev=1) ‚Äî –í–ö–õ–Æ–ß–ï–ù
–ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã –Ω–∞—Ä—É—à–µ–Ω–∏—è, —Å–∫—Ä–∏–ø—Ç:
1) –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫—Ä–∞—Å–Ω—ã–π –±–∞–Ω–Ω–µ—Ä (CRITICAL GUARD).
2) –ü–∏—à–µ—Ç –ª–æ–≥ –Ω–∞—Ä—É—à–µ–Ω–∏–π –≤ localStorage.
3) –î–µ–ª–∞–µ—Ç ¬´–∞–≤—Ç–æ‚Äë—Å–∫—Ä–∏–Ω—à–æ—Ç¬ª –ø–∞–Ω–µ–ª–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (PNG) –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ localStorage (–ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–Ω–∏–º–æ–∫).
4) –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ: `window.stop()` –∏ `throw Error(...)`, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å ¬´—Ç–∏—Ö–∏—Ö¬ª –Ω–µ–≤–µ—Ä–Ω—ã—Ö —Ü–∏—Ñ—Ä.

## –ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥ –∏ —Å–∫—Ä–∏–Ω—à–æ—Ç
### –õ–æ–≥
localStorage key:
- `JKH_CRITICAL_GUARD_LOG`

–§–æ—Ä–º–∞—Ç: –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ `{at, page, href, userAgent, messages[]}` (—Ö—Ä–∞–Ω–∏—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ ~50 –∑–∞–ø–∏—Å–µ–π).

### –°–∫—Ä–∏–Ω—à–æ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (PNG dataURL)
localStorage keys:
- `JKH_CRITICAL_GUARD_LAST_SHOT_PNG`
- `JKH_CRITICAL_GUARD_LAST_SHOT_META`

–í–∞–∂–Ω–æ: —Å–∫—Ä–∏–Ω—à–æ—Ç ‚Äî —ç—Ç–æ **–ø–∞–Ω–µ–ª—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è**, –∞ –Ω–µ –≤—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (—ç—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ file://).

## –í–∞–∂–Ω–æ
- –í –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ (–±–µ–∑ `?dev=1`) —Å–∫—Ä–∏–ø—Ç –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç.
- –≠—Ç–æ –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω—ã—Ö –ø—Ä–∞–≤–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞—Å—á—ë—Ç—ã –∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –æ—à–∏–±–∫–µ.


## –ö–Ω–æ–ø–∫–∏ –Ω–∞ –±–∞–Ω–Ω–µ—Ä–µ (dev=1)
- **–û—Ç–∫—Ä—ã—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç** ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π PNG –∏–∑ localStorage (`JKH_CRITICAL_GUARD_LAST_SHOT_PNG`).
- **–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç** ‚Äî –∫–æ–ø–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ –Ω–∞—Ä—É—à–µ–Ω–∏–π + URL + –≤—Ä–µ–º—è –≤ –±—É—Ñ–µ—Ä (clipboard) —Å fallback –¥–ª—è `file://`.
